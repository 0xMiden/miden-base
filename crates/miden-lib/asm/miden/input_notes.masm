use.miden::kernel_proc_offsets

#! Returns the information about assets in the input note with the specified index.
#!
#! This information can then be used to retrieve the actual assets from the advice map.
#!
#! Inputs:  [note_index]
#! Outputs: [ASSETS_HASH, num_assets]
#!
#! Where:
#! - note_index is the index of the input note which assets info should be returned.
#! - num_assets is the number of assets in the note which has been requested.
#! - ASSETS_HASH is the vault hash of the note which has been requested.
#!
#! Panics if:
#! - the note index is greater or equal to the overall number of input notes.
#!
#! Invocation: exec
export.get_assets_info
    # start padding the stack
    push.0.0 movup.2
    # => [note_index, 0, 0]

    exec.kernel_proc_offsets::input_note_get_assets_info_offset
    # => [offset, note_index, 0, 0]

    # pad the stack
    padw swapw padw padw swapdw
    # => [offset, note_index, pad(14)]

    syscall.exec_kernel_proc
    # => [ASSETS_HASH, num_assets, pad(11)]

    # clean the stack
    swapdw dropw dropw 
    repeat.3
        movup.5 drop
    end
    # => [ASSETS_HASH, num_assets]
end