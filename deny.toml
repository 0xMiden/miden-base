# cargo-deny configuration for DeepProve workspace

# Graph configuration
[graph]
targets = ["aarch64-apple-darwin", "x86_64-apple-darwin", "x86_64-pc-windows-msvc", "x86_64-unknown-linux-gnu"]

# Advisory database configuration
[advisories]
db-path = "~/.cargo/advisory-db"
db-urls = ["https://github.com/rustsec/advisory-db"]
ignore = [
  "RUSTSEC-2024-0436", # paste is unmaintained but no alternative available
  "RUSTSEC-2025-0055", # tracing-subscriber vulnerability - will be fixed by upgrade
  "RUSTSEC-2025-0056", # adler is unmaintained but used by miniz_oxide
]
yanked = "warn"

# License configuration
[licenses]
allow = [
    "MIT",
    "Apache-2.0",
    "Apache-2.0 WITH LLVM-exception",
    "BSD-2-Clause",
    "BSD-3-Clause",
    "CC0-1.0",
    "ISC",
    "Zlib",
    "Unicode-3.0",
]
exceptions = [
  # Each entry is the crate and version constraint, and its specific allowed licenses
  #{ allow = ["Zlib"], name = "adler32", version = "*" },
]

# Bans configuration
[bans]
allow = [
  #{ name = "ansi_term", version = "=0.11.0" },
]
deny = [
  #{ name = "ansi_term", version = "=0.11.0" },
]
highlight = "all"
multiple-versions = "deny"
skip = [
  #{ name = "ansi_term", version = "=0.11.0" },
]
skip-tree = [
    # Allow getrandom v0.2.x for now - will be phased out with nanorand
    { name = "getrandom", version = "=0.2.*" },
    # Allow rand_core v0.6.x for now - legacy dependency
    { name = "rand_core", version = "=0.6.*" },
    # Allow rustc_version v0.2.x - build dependency
    { name = "rustc_version", version = "=0.2.*" },
    # Allow windows-targets v0.48.x - older Windows target
    { name = "windows-targets", version = "=0.48.*" },
    # Allow unicode-width v0.1.x - conflicting dependencies in ecosystem
    { name = "unicode-width", version = "=0.1.*" },
    # Allow windows-sys v0.48.x/v0.59.x - multiple Windows system libraries (hard to converge)
    { name = "windows-sys", version = "=0.48.*" },
    { name = "windows-sys", version = "=0.59.*" },
]
wildcards = "allow"

# Sources configuration
[sources]
allow-registry   = ["https://github.com/rust-lang/crates.io-index"]
unknown-git      = "deny"
unknown-registry = "deny"
